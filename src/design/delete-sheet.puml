@startuml Delete_Sheet_Flow
!theme plain
skinparam backgroundColor #FAFAFA
skinparam sequence {
    ArrowColor #1976D2
    ActorBorderColor #0D47A1
    LifeLineBorderColor #42A5F5
    LifeLineBackgroundColor #E3F2FD
    ParticipantBorderColor #1565C0
    ParticipantBackgroundColor #BBDEFB
}

title Sequence 6: Delete Attendance Sheet

actor Professor
participant "Express\nServer" as Express
participant "Sheet\nRouter" as Router
participant "Async\nHandler" as Async
participant "Sheet\nController" as Controller
participant "Sheet\nService" as Service
participant "Sheet\nModel" as Model
database MongoDB

Professor -> Express: DELETE /api/v1/sheets/:id
activate Express

Express -> Router: Route request
activate Router

Router -> Async: asyncHandler(deleteSheet)
activate Async

Async -> Controller: deleteSheet(req, res, next)
activate Controller

Controller -> Service: deleteSheet(req.params._id)
activate Service

Service -> Model: findByIdAndDelete(id)
activate Model

Model -> MongoDB: Delete document
activate MongoDB
MongoDB --> Model: Deleted document
deactivate MongoDB

Model --> Service: Deletion result
deactivate Model

Service --> Controller: Completed
deactivate Service

Controller -> Controller: res.status(204)
Controller --> Express: No content response
deactivate Controller
deactivate Async
deactivate Router

Express --> Professor: 204 No Content
deactivate Express

note right of Professor
    204 indicates successful
    deletion with no content
    returned in response
end note

@enduml