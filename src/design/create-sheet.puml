@startuml Create_Attendance_Sheet
!theme plain
skinparam backgroundColor #FAFAFA
skinparam sequence {
    ArrowColor #1976D2
    ActorBorderColor #0D47A1
    LifeLineBorderColor #42A5F5
    LifeLineBackgroundColor #E3F2FD
    ParticipantBorderColor #1565C0
    ParticipantBackgroundColor #BBDEFB
}

title Sequence 1: Professor Creates Attendance Sheet

actor Professor
participant "Express\nServer" as Express
participant "Sheet\nRouter" as Router
participant "Async\nHandler" as Async
participant "Sheet\nController" as Controller
participant "Sheet\nService" as Service
participant "Sheet\nModel" as Model
database MongoDB

Professor -> Express: POST /api/v1/sheets\n{className, location, isActive}
activate Express

Express -> Router: Route request
activate Router

Router -> Async: asyncHandler(createSheet)
activate Async

Async -> Controller: createSheet(req, res, next)
activate Controller

Controller -> Service: createSheet(req.body)
activate Service
note right of Service: Validate input data

Service -> Model: create(data)
activate Model

Model -> MongoDB: Insert document
activate MongoDB
MongoDB --> Model: Created document
deactivate MongoDB

Model --> Service: ISheet instance
deactivate Model

Service --> Controller: Created sheet
deactivate Service

Controller -> Controller: res.status(201)
Controller --> Express: JSON response
deactivate Controller
deactivate Async
deactivate Router

Express --> Professor: 201 Created\n{sheet details}
deactivate Express

@enduml